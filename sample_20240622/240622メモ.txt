


==========================================================================
==========================================================================
==========================================================================


全8回



=====================================
24/06/22 第4回目
=====================================

---【前半：座学】---

ローカル座標・ワールド座標

ワールド空間は最小的には2次元のスクリーンに表示される。

3次元のワールド空間にオブジェクトが存在している。
マウスカーソルは2次元に存在している。
なので、衝突判定がややこしい。
座標の変換が必要。

メートル表記と緯度経度表記の地図を比較するには？
どちらかの表記に揃えないといけない。


「まず２次元、３次元の各座標概念をクリアにする必要がありますね。。？」
　┗　そうだけど、そんなに難しく考えなくて良い。
　　　2次元と3次元の空間は全然違うと認識するだけでOK。





---【後半：実習】---

---【024】---

「オブジェクトがすごく奥にあって見えない状態でもレイキャスターで交差判定されますか？」
┗　ニアクリップ、ファークリップの外側にあるものは反応しない。
内側にあれば、遠くにあっても反応する。

レイキャスターはCPUで処理している。
メッシュが細ければ細かいほど、頂点が多ければ多いほど、CPU負荷が高くなる…！カクつく。


「うまく言葉にできなくてすみませんが、例えば、Raycasterを使ってクリックしたオブジェクトが「A」(aria-labelの的な名前？)という名前のオブジェクトだった場合、それを取得することは可能でしょうか？」
┗　メッシュに名前やuuidを設定できる。userDataでも。

「ちなみに一般的にメッシュに名前ってつけるのでしょうか？」
┗　必要がなければつけなくて良い。だいたい自分で名前をつけた変数に入れているので…。
あんまりしないかな…。名前つけたいときがないかも。

「逆に使う事例ってありますか？」
┗　あんまりない…。nameプロパティが無いと出来ないこと、というのがない。
好みの問題かも。




---【025】---

Float32Array　：数字しか入らない。32bitのフロートしか入らない。

「このposition属性は、meshの位置を設定するためのposition.yとは全くの別物の話ですよね？」
┗　全然別ですね！今やっているのはローカル空間のジオメトリを作っている作業。



---【026】---

ポイントスプライト

「コメントでビルボードと書いてあるのですが、ここでいうビルボードはどういう意味ですか？」
┗　描画負荷が高くなってしまうときに、ビルボードを使う。
木とか、頂点が多いオブジェクトがたくさんある場合、ビルボードを使用して負荷を抑える。
古くからあるテクニック。。。


「追加で質問なんですが、 points.lookAt(camera)みたいにしたら、また違う挙動ですか？」
┗　ぜんぜん違う。。ジオメトリ全体としては姿勢は変わるけど、点の向きは変わらない。
そもそも点に傾きや厚みは無い。


「星が重なると、奥にある星に影のようなものが重なって見えるのですが、pointのポリゴンが正方形でそれが透過されていないため、ということでしょうか？」
┗　その通りです。


「少し話題が戻ってしまいますが、 sizeAttenuationをtrueにしたときの見え方が、平行投影のカメラで見たときと同じように見えました。これは全く違う概念ですよね？」
┗　falseじゃないかな？そうですね、違う概念です。
空間自体はパースの掛かったカメラで表示されている




---【027】---

メッシュごと（Object3Dごと）にZソートしてくれるが、
今回はジオメトリ内で頂点がたくさんあるので、メッシュごとのZソートが適応されない。

大量の頂点を1つのジオメトリでシーンにaddする　→　早いがZソートされない
1つの頂点を大量のメッシュでシーンにaddする　→　めっちゃ重くなる。GPUで描画が早くなるというメリットを捨てることになる。

どちらを選ぶか。。。

CG的には一回で出来るだけまとめてドカッと書いたほうが良い。早い。

blending mode を AdditiveBlending に切り替える。
加算合成
AdditiveBlending はどんどん色を足していくので、見た目の違いがわからなくなってくる（いい意味で）。

この辺は感覚や経験かも…。
これが絶対の正解ではない…！



「ちょっと戻るんですが、（さっきの木のような）長方形のビルボードを作りたい場合、 大きめのポイントに左右が透明になっている木の画像を貼る、でいいんでしょうか？」
┗　普通のビルボードをやりたい場合、木とかなら、点では表現しきれない。
大きめのポイントではなく、ポリゴンでやらないとダメですね。
プレーンジオメトリとかでやる。
テクスチャを貼ったポリゴンにする。

（ブログ記事）
Y軸だけビルボードにすると、まぁちゃんと見えるけど、ちゃんと計算しないといけない。

ポイントスプライトをビルボードで使う場面は限られる。
例えば銀河とか…。
木とかは難しい。。。CG的な難しさ。




---【028】---

Sketchfab - The best 3D viewer on the web
3D Models for Professionals :: TurboSquid
Free3D.com






---【029】---

暗記しなくてOK
ミキサー
アクション


「サイトなどからモデルをダウンロードする前に、事前にアニメーション情報って確認できますか？」
┗　サイトのインターフェースによりけり…。
Sketchfabとかはわかるかも。


Babylon.js Sandbox - View glTF, glb, obj and babylon files
ここに入れるとglTFが確認できる。
出来ないことがほぼ無い。テクスチャなども変更できる…！



「この狐のデータの場合「一定時間首を振ってから首振りを停止、つぎに歩き出す」ようなアニメーションをしたい場合はrequestAnimationFrame内で各ウェイトを制御するイメージですか？ウェイトもいきなり1.0->0.0にすると不自然なアニメになりそうですから、うまいこと制御するのだろうなと思います。」
┗　仰るとおり。。3秒間は首振りウェイトを1にして、次の1秒間で0.5にして……など。
ヨコの動き（走って移動）を最初からモデルに入れておく…というのもアリ。
ケースバイケース。


「紹介されていたサイトなどの無料の3Dモデルを使用する際に、ライセンスなどで注意するポイントはありますか？（Webの場合、アップしたら誰でもモデルにアクセスできると思うので、再頒布的な扱いになるのかなと）」
┗　怪しかったら本人に聞いてみるしか無い…。「この使い方は大丈夫？」
有料のものは大抵大丈夫…。


「経過時間をつかってアニメーションを実装する場合、別タブに移動してる間も経過時間って進んでいるのでしょうか？ もし進んでいるとしたら、別タブに移動中は経過時間を止めて戻ってきた時に再度経過時間を取得するてことでしょうか？」
┗　別タブに行ってても、時間は進む。







---【030】---




---【031】---






---【まとめ】---




課題：



------------------
【講義後の質問】
------------------


